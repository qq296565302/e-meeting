<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>用户组</title>
		<!--页面的元信息-->
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Co<strong>m</strong>patible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<!-- 新 Bootstrap4 核心 CSS 文件 -->
		<link rel="stylesheet" type="text/css" href="css/bootstrap4.0.0.min.css" />
		<!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
		<script src="js/jquery3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
		<!-- popper.min.js 用于弹窗、提示、下拉菜单 -->
		<script src="js/popper.min.js" type="text/javascript" charset="utf-8"></script>
		<!-- 最新的 Bootstrap4 核心 JavaScript 文件 -->
		<script src="js/bootstrap4.0.0.min.js" type="text/javascript" charset="utf-8"></script>
		<!-- 自定义CSS -->
		<link rel="stylesheet" href="css/main.css">
		<!--图标-->
		<link rel="stylesheet" type="text/css" href="css/font.css" />
	</head>

	<body class="gray-body">
		<div class="container-fluid">
			<!--用户组 开始-->
			<div class="row align-items-center user-group">
				<!--左侧选择区域-->
				<div class="col-5 user-selection-left">
					<div class="user-selection">
						<!--部门选择组一 开始-->
						<div class="row selection-group">
							<!--标题栏-->
							<div class="col-12 selection-th">
								<div class="row">
									<div class="col-9 selection-th-title">
										<p><i class="iconfont icon-zhankai"></i>部门名称</p>
									</div>
									<div class="col-1 selection-th-checkbox" id="selection-th-checkbox-1">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
							</div>
							<!--展开栏-->
							<div class="col-12 selection-tb selection-tb-active" id="selection-tb-1">
								<div class="row">
									<div class="col-9 selection-tb-title">
										<p class="user-name">一姓名1</p>
									</div>
									<div class="col-1 selection-tb-checkbox" id="tb-checkbox-1-1">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
								<div class="row">
									<div class="col-9 selection-tb-title">
										<p class="user-name">一姓名2</p>
									</div>
									<div class="col-1 selection-tb-checkbox" id="tb-checkbox-1-2">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
								<div class="row">
									<div class="col-9 selection-tb-title">
										<p class="user-name">一姓名3</p>
									</div>
									<div class="col-1 selection-tb-checkbox" id="tb-checkbox-1-3">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
							</div>
						</div>
						<!--部门选择组一 结束-->

						<!--部门选择组二 开始-->
						<div class="row selection-group">
							<!--标题栏-->
							<div class="col-12 selection-th">
								<div class="row">
									<div class="col-9 selection-th-title">
										<p><i class="iconfont icon-shouqi"></i>部门名称</p>
									</div>
									<div class="col-1 selection-th-checkbox" id="selection-th-checkbox-2">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
							</div>
							<!--展开栏-->
							<div class="col-12 selection-tb" id="selection-tb-2">
								<div class="row">
									<div class="col-9 selection-tb-title">
										<p class="user-name">二姓名1</p>
									</div>
									<div class="col-1 selection-tb-checkbox" id="tb-checkbox-2-1">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
								<div class="row">
									<div class="col-9 selection-tb-title">
										<p class="user-name">二姓名2</p>
									</div>
									<div class="col-1 selection-tb-checkbox" id="tb-checkbox-2-2">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
								<div class="row">
									<div class="col-9 selection-tb-title">
										<p class="user-name">二姓名3</p>
									</div>
									<div class="col-1 selection-tb-checkbox" id="tb-checkbox-2-3">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
							</div>
						</div>
						<!--部门选择组二 结束-->

						<!--部门选择组三 开始-->
						<div class="row selection-group">
							<!--标题栏-->
							<div class="col-12 selection-th">
								<div class="row">
									<div class="col-9 selection-th-title">
										<p><i class="iconfont icon-shouqi"></i>部门名称</p>
									</div>
									<div class="col-1 selection-th-checkbox" id="selection-th-checkbox-3">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
							</div>
							<!--展开栏-->
							<div class="col-12 selection-tb" id="selection-tb-3">
								<div class="row">
									<div class="col-9 selection-tb-title">
										<p class="user-name">三姓名1</p>
									</div>
									<div class="col-1 selection-tb-checkbox" id="tb-checkbox-3-1">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
								<div class="row">
									<div class="col-9 selection-tb-title">
										<p class="user-name">三姓名2</p>
									</div>
									<div class="col-1 selection-tb-checkbox" id="tb-checkbox-3-2">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
								<div class="row">
									<div class="col-9 selection-tb-title">
										<p class="user-name">三姓名3</p>
									</div>
									<div class="col-1 selection-tb-checkbox" id="tb-checkbox-3-3">
										<p><i class="iconfont icon-weixuanzhong"></i></p>
									</div>
								</div>
							</div>
						</div>
						<!--部门选择组三 结束-->
					</div>
				</div>
				<!--中间移动按钮-->
				<div class="col-2 user-move">
					<img src="img/right.png" alt="" id="add-user-btn" />
					<img src="img/left.png" alt="" id="remove-user-btn" />
				</div>
				<!--右侧选择区域-->
				<div class="col-5 user-selection-right">
					<div class="userd-selection">
						<!--<div class="row selected">
							<div class="col-8 selected-name">
								<p class="selected-name-p">姓名</p>
							</div>
							<div class="col-1 selected-icon">
								<i class="iconfont icon-shanchu"></i>
							</div>
						</div>-->
					</div>
				</div>
			</div>
			<!--用户组 结束-->
		</div>
	</body>

</html>
<script type="text/javascript">
	//创建数组存放选中的用户名
	var user_arr = Array();
	var userd_arr = Array();
	var del_arr = Array();
	//创建个变量,用来赋值id
	var var_id = 0;
	//快速预订:用户组 点击展开收起
	$(".selection-th-title").click(function() {
		var this_tb = "#" + $(this).parent(".row").parent(".selection-th").next(".selection-tb").attr("id");
		$(this_tb).slideToggle("fast");
		$(this).children("p").children(".iconfont").toggleClass("icon-shouqi");
		$(this).children("p").children(".iconfont").toggleClass("icon-zhankai");
	})
	//点击选中未选中>>>>>>>>>>>>>>>>>>>>> selection-TH-checkbox
	$(".selection-th-checkbox").click(function() {
		var this_check = "#" + $(this).attr("id") + " i";
		var this_tb = "#" + $(this).parent(".row").parent(".selection-th").next(".selection-tb").attr("id") + " i";
		$(this_check).toggleClass("icon-xuanzhong");
		$(this_check).toggleClass("icon-weixuanzhong");
		if($(this_check).attr("class") == "iconfont icon-xuanzhong") {
			//全部选中了
			$(this_tb).removeClass("icon-weixuanzhong");
			$(this_tb).addClass("icon-xuanzhong");
			//把所有用户名加入数组
			var add_title = $(this).parents(".selection-group").children(".selection-tb").children(".row").children(".selection-tb-title").children(".user-name");
			add_title.each(function() {
				if($.inArray($(this).text(), user_arr) == -1) {
					user_arr.push($(this).text());
				}
			});
		} else {
			//全部取消了
			$(this_tb).addClass("icon-weixuanzhong");
			$(this_tb).removeClass("icon-xuanzhong");
			//把所有用户名移除数组
			var remove_title = $(this).parents(".selection-group").children(".selection-tb").children(".row").children(".selection-tb-title").children(".user-name");
			remove_title.each(function() {
				user_arr.splice($.inArray($(this).text(), user_arr), 1);
			});
		}
	})
	//点击选中未选中>>>>>>>>>>>>>>>>>>>>> selection-TB-checkbox
	$(".selection-tb-checkbox").click(function() {
		//图标切换
		var this_check = "#" + $(this).attr("id") + " i";
		$(this_check).toggleClass("icon-xuanzhong");
		$(this_check).toggleClass("icon-weixuanzhong");
		//加入或移除用户名
		var this_username = $(this).prev(".selection-tb-title").children(".user-name").html();
		if($.inArray(this_username, user_arr) == -1) {
			user_arr.push(this_username);
		} else {
			user_arr.splice($.inArray(this_username, user_arr), 1);
		}
	})
	//添加用户
	$("#add-user-btn").click(function() {
		var arr_len = user_arr.length;
		for(var i = 0; i < arr_len; i++) {
			var_id++;
			var add_username = "<div class='row selected'><div class='col-8 selected-name'><p class='selected-name-p' id='selected-name" + var_id + "' onclick='selected_active(this)'>" + user_arr[i] + "</p></div><div class='col-1 selected-icon'><i class='iconfont icon-shanchu'></i></div></div>"
			//如果当前要加入的数组内用户不在已加入用户数组内
			if($.inArray(user_arr[i], userd_arr) == -1) {
				userd_arr.push(user_arr[i]);
				$(".userd-selection").append(add_username);
			} else {
				console.log("已添加");
			}
		}
		//		alert(user_arr);
	})
	//已选中用户的点击事件
	function selected_active(e) {
		var this_class = "#" + e.getAttribute("id");
		$(this_class).parents(".selected").toggleClass("selected-active");
		if($.inArray($(this_class).attr("id"), del_arr) == -1) {
			del_arr.push($(this_class).attr("id"));
		} else {
			del_arr.splice($.inArray($(this_class).attr("id"), del_arr), 1);
		}
	}
	//删除用户组
	$("#remove-user-btn").click(function() {
		var del_len = del_arr.length;
		for(var i = 0; i < del_len; i++) {
			var del_id = "#" + del_arr[i];
			userd_arr.splice($.inArray($(del_id).html(), userd_arr), 1);
			$(del_id).parents(".selected").remove();
		}
		//清空删除用户的数组
		del_arr =Array();
	})
</script>